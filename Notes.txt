Things I need the systme to do:

Motor:

    Functionality to fully charge the system to 100 psi.
        Will probably need to see how long the system can stay pressurized at this psi. Stability test.
        Will also need active pressure monitoring during this process.

    Detect when there is a leak, and motor should not activate when pressure is detected to be below a specified level.

    Turn on when system is below a specified PSI level.
        Need logic to detect that the system psi is increasing so the motor doesn't run indefinitely. 

    Logic to detect when the motor shuts off because pressure limit has been reached. 
        This would allow us to be able to better tell when the system is fully pressurized. And we can


Pressure Transducer:
    Logic to simply read the transducer values every loop, and if they are under a certain pressure, pressurize the system again. This function should be standalone, should
    even be able to be ran at any point from another function.

    Logic to detect a catastrophic leak in the system.

Communications:
    Pressure and State logging over Wifi to track performance of the devices.
    Error logging to a server that sends notifications via phone messages or emails or something. 


Nozzles:
    The turn-on time needs to be characterized. I realize the spray is not 
    at 100% effectiveness for a few seconds as the water needs a moment to push past the air
    and unpressurized water in the system near the nozzles from the last run. It isnt as bad when 
    pressurizing one set of nozzles at a time though, so this may not be a big issue. Just keep in 
    mind of it though. THAT and we need to understand for how long we can spray with 5 nozzles for our system from 100psi to 80psi (or whichever lower end pressure)
    Solution for this might be to just bring the solenoids closer to the nozzles.

    Also check how long a set of nozzles can run on a full charge of water at 100 psi.

    Full function to do a full cycle of all four sides of nozzles. 
        i.e: (Continuous pressure monitoring)
            1. Activate Motor until system pressurized to 100 psi
Loop start  2. Activate Solenoid A for x seconds. Check PSI.
            3. If psi below a certain threshold, interrupt cycle and repressurize system
Loop End    4. If pressure between 90 and 100 psi, then we're good and can loop back to step 2


Serial Comms:
    This should be code to communicate over serial and take commands to do things so we dont have to keep reloading code to be able to test the system out.

    (Test,Duration) Is the format to use for running a test. May need to store the type of test based on the integer received. 

            
Could probably make it so that a node runs whatever tsk that needs to happen and the main loop just checksthe state of the button.
When that state changes, during a task execution it restarts the whole system. 

Testing Tasks:
Need the Button state printed and the pressure printed.
Perform max psi test, make sure it stops when button is pressed again for safety.

Function to find out min and max psi value, no matter the ADC value or attenuation. This should be a debug function
    Open solenoids for a bit and get the pressure of the system to 0psi. 
    Once system at 0 psi, close solenoids and take a moving average of the ADC values at 0 psi for about 10-20 seconds.
    Once lower psi value acquired, start pressurizing the motor.
    While motor is being pressurized, listen out for button press, and stop pressurizing when the button is pressed. (Button should be pressed when 100 psi reached)
    Once button pressed and we reached 100 psi, get a moving average/average of the ADC so we can know which ADC value/range correpsonds to 100 psi. 
    Once we have those min and max values, we can create a map; (Lower_ADCval, Higher_ADCval, 0psi, 100psi);

Function that perpetually calculates pressure using the map, and print to terminal. This should be an RTOS task.
We should probably pass it by reference whenever a function needs to know what the pressure is currently
    Should make movingAvg object.
    Read Transducer ADC, feed into movingAvg object and get avgdValue.
    Feed Avgdvalue into map. Return that value, and that should give us our current pressure

24Hr cycle function - function to manage misting over the period of 24hours. Misting in daytime is different that misting at night. How do we characterize this? 
Should this be a button to switch between the two? Or what can we do to let the system know it is nighttime/daytime? I think for now, I'll manually change day/night cycles 
    Function that should be an RTOS task
    It should take, misting cycle time in minutes (how often to mist). Misting period (How long to mist). Should listen for button press to edit these parameters. 
    Pressurizes system when under a certain pressure threshold, and goes back to misting cycle. If statement here probably.

Function to pressurize until MAX pressure reached

Function to print task list. This should be what the cycle function calls, because the button press will be a sign the user wants to change some Functionality.

Next task is to add the new functionality to the Serial command list

Need to find a better way to log psi, it has too many swings

Pin Function
10 purple - p transducer adc
9 green - button pin
8 red - SCLK
brown 3.3volts to VDD
taped wires = buttons, red = 3.3v, blk = gnd